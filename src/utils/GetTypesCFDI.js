const _0x530494=_0x1aab;(function(_0x15ff69,_0x1f475d){const _0x34c762=_0x1aab,_0x2b1eb5=_0x15ff69();while(!![]){try{const _0x483da4=parseInt(_0x34c762(0xf6))/0x1+parseInt(_0x34c762(0x112))/0x2+parseInt(_0x34c762(0x10f))/0x3*(-parseInt(_0x34c762(0xf2))/0x4)+parseInt(_0x34c762(0x10d))/0x5+-parseInt(_0x34c762(0xf3))/0x6*(parseInt(_0x34c762(0x100))/0x7)+-parseInt(_0x34c762(0xfd))/0x8*(-parseInt(_0x34c762(0xf7))/0x9)+-parseInt(_0x34c762(0xea))/0xa*(parseInt(_0x34c762(0x117))/0xb);if(_0x483da4===_0x1f475d)break;else _0x2b1eb5['push'](_0x2b1eb5['shift']());}catch(_0x419883){_0x2b1eb5['push'](_0x2b1eb5['shift']());}}}(_0x4aa2,0x6045e));const notifier=require(_0x530494(0xf1));require(_0x530494(0xeb))[_0x530494(0xdf)]({'path':_0x530494(0xec)});const axios=require(_0x530494(0xf0)),{runQuery}=require(_0x530494(0x109)),url=process[_0x530494(0x115)][_0x530494(0xff)],tenantIds=[],apiKeys=[],apiSecrets=[],databases=[],tenantIdValues=process[_0x530494(0x115)]['TENANT_ID'][_0x530494(0xfc)](','),apiKeyValues=process[_0x530494(0x115)][_0x530494(0x10a)]['split'](','),apiSecretValues=process[_0x530494(0x115)][_0x530494(0x102)]['split'](','),databaseValues=process[_0x530494(0x115)][_0x530494(0x11f)][_0x530494(0xfc)](',');tenantIds['push'](...tenantIdValues),apiKeys['push'](...apiKeyValues),apiSecrets[_0x530494(0x113)](...apiSecretValues),databases[_0x530494(0x113)](...databaseValues);async function getTypeP(_0x29752f){const _0x1526a9=_0x530494;let _0x2dc68a=new Date()[_0x1526a9(0x120)](),_0x200c71=new Date()[_0x1526a9(0xf4)]()+0x1,_0x45120b=new Date()['getFullYear']();try{const _0x91a80=await axios[_0x1526a9(0xe1)](url+_0x1526a9(0xed)+tenantIds[_0x29752f]+_0x1526a9(0x104)+_0x45120b+'-'+_0x200c71+'-'+_0x2dc68a+_0x1526a9(0x11c)+_0x45120b+_0x1526a9(0x11a),{'headers':{'PDPTenantKey':apiKeys[_0x29752f],'PDPTenantSecret':apiSecrets[_0x29752f]}});if(_0x91a80[_0x1526a9(0xe6)][_0x1526a9(0x111)]===0x0)return console['log'](_0x1526a9(0xf9)),[];const _0x4a12ad=[];for(const _0x4885e6 of _0x91a80['data'][_0x1526a9(0x10c)]){console['log'](_0x4885e6[_0x1526a9(0xe0)]['payment_info'][_0x1526a9(0x110)][_0x1526a9(0xfb)]);if(_0x4885e6[_0x1526a9(0xe0)][_0x1526a9(0xde)][_0x1526a9(0x110)][_0x1526a9(0xfb)]===0x0){console['log']('UUID\x20'+_0x4885e6[_0x1526a9(0x106)][_0x1526a9(0xf5)][_0x1526a9(0xe2)]+'\x20eliminado\x20por\x20no\x20tener\x20pagos');continue;}const _0xeeb605=_0x1526a9(0xe4)+_0x4885e6[_0x1526a9(0x106)][_0x1526a9(0xe9)]['rfc']+'\x27;';try{const _0x1ba003=await runQuery(_0xeeb605);if(_0x1ba003[_0x1526a9(0x119)][0x0][_0x1526a9(0xfa)]===0x0){console[_0x1526a9(0x116)](_0x1526a9(0x103)+_0x4885e6[_0x1526a9(0x106)]['timbre']['uuid']+_0x1526a9(0x11d));continue;}const _0x495a0a=_0x1526a9(0x11b)+_0x4885e6['cfdi'][_0x1526a9(0xf5)][_0x1526a9(0xe2)]+'\x27;',_0x2f7415=await runQuery(_0x495a0a,databases[_0x29752f]);if(_0x2f7415[_0x1526a9(0x119)][0x0]['NREG']>0x0){console[_0x1526a9(0x116)](_0x1526a9(0x103)+_0x4885e6[_0x1526a9(0x106)][_0x1526a9(0xf5)][_0x1526a9(0xe2)]+'\x20eliminado\x20por\x20ser\x20ya\x20timbrado');continue;}console[_0x1526a9(0x116)](_0x1526a9(0x103)+_0x4885e6[_0x1526a9(0x106)][_0x1526a9(0xf5)][_0x1526a9(0xe2)]+_0x1526a9(0x118)),_0x4a12ad[_0x1526a9(0x113)](_0x4885e6);}catch(_0xd4d8a9){console[_0x1526a9(0x116)]('Error\x20executing\x20query:\x20'+_0xd4d8a9);}}return _0x4a12ad;}catch(_0x5349c4){try{notifier[_0x1526a9(0xe8)]({'title':'Focaltec','message':_0x1526a9(0xe7)+_0x5349c4+'\x0a','sound':!![],'wait':!![],'icon':process['cwd']()+'/public/img/cerrar.png'});}catch(_0x314295){console['log'](_0x1526a9(0x10e)+_0x314295),console[_0x1526a9(0x116)](_0x1526a9(0xe7)+_0x5349c4+'\x0a');}return[];}}async function getTypeI(_0xa722f8){const _0x3753bb=_0x530494;let _0x409bf4=new Date()[_0x3753bb(0x120)](),_0x1cd62b=new Date()[_0x3753bb(0xf4)]()+0x1,_0x34f37e=new Date()[_0x3753bb(0x114)]();try{const _0x2a72b2=await axios[_0x3753bb(0xe1)](url+_0x3753bb(0xed)+tenantIds[_0xa722f8]+'/cfdis?createdUntil='+_0x34f37e+'-'+_0x1cd62b+'-'+_0x409bf4+_0x3753bb(0x11c)+_0x34f37e+_0x3753bb(0x105),{'headers':{'PDPTenantKey':apiKeys[_0xa722f8],'PDPTenantSecret':apiSecrets[_0xa722f8]}});if(_0x2a72b2[_0x3753bb(0xe6)][_0x3753bb(0x111)]===0x0)return console[_0x3753bb(0x116)](_0x3753bb(0xf8)),[];const _0x158264=[];for(const _0x3e4cf0 of _0x2a72b2[_0x3753bb(0xe6)][_0x3753bb(0x10c)]){const _0x158aef=_0x3753bb(0xe4)+_0x3e4cf0[_0x3753bb(0x106)][_0x3753bb(0xe9)][_0x3753bb(0x11e)]+'\x27;';try{const _0x409688=await runQuery(_0x158aef);if(_0x409688[_0x3753bb(0x119)][0x0][_0x3753bb(0xfa)]===0x0){console[_0x3753bb(0x116)](_0x3753bb(0x103)+_0x3e4cf0[_0x3753bb(0x106)]['timbre'][_0x3753bb(0xe2)]+_0x3753bb(0x11d));continue;}const _0x4bc54c='SELECT\x20COUNT(*)\x20AS\x20NREG\x20FROM\x20APIBH\x20H,\x20APIBHO\x20O\x20WHERE\x20H.CNTBTCH\x20=\x20O.CNTBTCH\x20AND\x20H.CNTITEM\x20=\x20O.CNTITEM\x20AND\x20H.ERRENTRY\x20=\x200\x20AND\x20O.OPTFIELD\x20=\x20\x27FOLIOCFD\x27\x20AND\x20[VALUE]\x20=\x20\x27'+_0x3e4cf0[_0x3753bb(0x106)]['timbre'][_0x3753bb(0xe2)]+'\x27;',_0x1d2d69=await runQuery(_0x4bc54c,databases[_0xa722f8]);if(_0x1d2d69[_0x3753bb(0x119)][0x0]['NREG']>0x0){console[_0x3753bb(0x116)](_0x3753bb(0x103)+_0x3e4cf0['cfdi'][_0x3753bb(0xf5)][_0x3753bb(0xe2)]+_0x3753bb(0xfe));continue;}console[_0x3753bb(0x116)](_0x3753bb(0x103)+_0x3e4cf0[_0x3753bb(0x106)][_0x3753bb(0xf5)][_0x3753bb(0xe2)]+_0x3753bb(0x118)),_0x158264[_0x3753bb(0x113)](_0x3e4cf0);}catch(_0x205091){console[_0x3753bb(0x116)](_0x3753bb(0x10b)+_0x205091);}}return _0x158264;}catch(_0x5376d7){try{notifier[_0x3753bb(0xe8)]({'title':'Focaltec','message':_0x3753bb(0xe5)+_0x5376d7+'\x0a','sound':!![],'wait':!![],'icon':process[_0x3753bb(0xee)]()+'/public/img/cerrar.png'});}catch(_0x2534d5){console[_0x3753bb(0x116)]('Error\x20al\x20enviar\x20notificacion:\x20'+_0x2534d5),console[_0x3753bb(0x116)](_0x3753bb(0xe5)+_0x5376d7+'\x0a');}return[];}}function _0x4aa2(){const _0x365dc4=['\x20eliminado\x20por\x20falta\x20de\x20RFCReceptor\x20en\x20fesa','rfc','DATABASES','getDate','payment_info','config','metadata','get','uuid','No\x20hay\x20CFDI\x20de\x20tipo\x20E','SELECT\x20COUNT(*)\x20AS\x20NREG\x20FROM\x20fesaParam\x20WHERE\x20Parametro\x20=\x20\x27RFCReceptor\x27\x20AND\x20VALOR\x20=\x20\x27','Error\x20al\x20obtener\x20el\x20tipo\x20de\x20comprobante\x20\x22I\x22\x20:\x20\x0a','data','Error\x20al\x20obtener\x20el\x20tipo\x20de\x20comprobante\x20\x22P\x22\x20:\x20\x0a','notify','receptor','1333250gkVDkh','dotenv','.env.credentials.focaltec','/api/1.0/extern/tenants/','cwd','Error\x20al\x20obtener\x20el\x20tipo\x20de\x20comprobante\x20\x22E\x22\x20:\x20\x0a','axios','node-notifier','4oSURng','6JSPafs','getMonth','timbre','727508PIpEYP','9HSTbuH','No\x20hay\x20CFDI\x20de\x20tipo\x20I','No\x20hay\x20CFDI\x20de\x20tipo\x20P','NREG','length','split','4824888zMtBwa','\x20eliminado\x20por\x20ser\x20ya\x20timbrado','URL','2562973JgKJcy','-01-01&documentTypes=CFDI&cfdiType=CREDIT_NOTE','API_SECRET','UUID\x20','/cfdis?createdUntil=','-01-01&documentTypes=CFDI&cfdiType=INVOICE&stage=PENDING_TO_PAY','cfdi','exports','/public/img/cerrar.png','./SQLServerConnection','API_KEY','Error\x20executing\x20query:\x20','items','544295sEZEPD','Error\x20al\x20enviar\x20notificacion:\x20','1529529hmWiOE','payments','total','194976WbNuCC','push','getFullYear','env','log','22IceNOU','\x20conservado','recordset','-01-01&documentTypes=CFDI&cfdiType=PAYMENT_CFDI','SELECT\x20COUNT(*)\x20AS\x20NREG\x20FROM\x20APIBH\x20H,\x20APIBHO\x20O\x20WHERE\x20H.CNTBTCH\x20=\x20O.CNTBTCH\x20AND\x20H.CNTITEM\x20=\x20O.CNTITEM\x20AND\x20H.ERRENTRY\x20=\x200\x20AND\x20O.OPTFIELD\x20=\x20\x27FOLIOCFD\x27\x20AND\x20[VALUE]\x20=\x20\x27','&createdFrom='];_0x4aa2=function(){return _0x365dc4;};return _0x4aa2();}function _0x1aab(_0x395a09,_0x46e15e){const _0x4aa214=_0x4aa2();return _0x1aab=function(_0x1aabfd,_0x43a0f1){_0x1aabfd=_0x1aabfd-0xde;let _0x1d6ef7=_0x4aa214[_0x1aabfd];return _0x1d6ef7;},_0x1aab(_0x395a09,_0x46e15e);}async function getTypeE(_0x18610f){const _0x1a78ac=_0x530494;let _0x535b0d=new Date()[_0x1a78ac(0x120)](),_0x22b73b=new Date()[_0x1a78ac(0xf4)]()+0x1,_0x2e8b38=new Date()[_0x1a78ac(0x114)]();try{const _0x41a8dd=await axios['get'](url+_0x1a78ac(0xed)+tenantIds[_0x18610f]+_0x1a78ac(0x104)+_0x2e8b38+'-'+_0x22b73b+'-'+_0x535b0d+_0x1a78ac(0x11c)+_0x2e8b38+_0x1a78ac(0x101),{'headers':{'PDPTenantKey':apiKeys[_0x18610f],'PDPTenantSecret':apiSecrets[_0x18610f]}});if(_0x41a8dd[_0x1a78ac(0xe6)][_0x1a78ac(0x111)]===0x0)return console['log'](_0x1a78ac(0xe3)),[];const _0x1db294=[];for(const _0x37a24e of _0x41a8dd[_0x1a78ac(0xe6)]['items']){const _0x349487='SELECT\x20COUNT(*)\x20AS\x20NREG\x20FROM\x20fesaParam\x20WHERE\x20Parametro\x20=\x20\x27RFCReceptor\x27\x20AND\x20VALOR\x20=\x20\x27'+_0x37a24e[_0x1a78ac(0x106)][_0x1a78ac(0xe9)][_0x1a78ac(0x11e)]+'\x27;';try{const _0xa74681=await runQuery(_0x349487);if(_0xa74681[_0x1a78ac(0x119)][0x0][_0x1a78ac(0xfa)]===0x0){console[_0x1a78ac(0x116)]('UUID\x20'+_0x37a24e[_0x1a78ac(0x106)]['timbre']['uuid']+_0x1a78ac(0x11d));continue;}const _0x17e3b8=_0x1a78ac(0x11b)+_0x37a24e[_0x1a78ac(0x106)][_0x1a78ac(0xf5)]['uuid']+'\x27;',_0x250753=await runQuery(_0x17e3b8,databases[_0x18610f]);if(_0x250753[_0x1a78ac(0x119)][0x0][_0x1a78ac(0xfa)]>0x0){console[_0x1a78ac(0x116)](_0x1a78ac(0x103)+_0x37a24e[_0x1a78ac(0x106)][_0x1a78ac(0xf5)][_0x1a78ac(0xe2)]+_0x1a78ac(0xfe));continue;}console[_0x1a78ac(0x116)](_0x1a78ac(0x103)+_0x37a24e[_0x1a78ac(0x106)][_0x1a78ac(0xf5)][_0x1a78ac(0xe2)]+_0x1a78ac(0x118)),_0x1db294[_0x1a78ac(0x113)](_0x37a24e);}catch(_0x1c39ce){console[_0x1a78ac(0x116)]('Error\x20executing\x20query:\x20'+_0x1c39ce);}}return _0x1db294;}catch(_0x41c350){try{notifier[_0x1a78ac(0xe8)]({'title':'Focaltec','message':'Error\x20al\x20obtener\x20el\x20tipo\x20de\x20comprobante\x20\x22E\x22\x20:\x20\x0a'+_0x41c350+'\x0a','sound':!![],'wait':!![],'icon':process[_0x1a78ac(0xee)]()+_0x1a78ac(0x108)});}catch(_0x41bff4){console[_0x1a78ac(0x116)](_0x1a78ac(0x10e)+_0x41bff4),console['log'](_0x1a78ac(0xef)+_0x41c350+'\x0a');}return[];}}module[_0x530494(0x107)]={'getTypeP':getTypeP,'getTypeI':getTypeI,'getTypeE':getTypeE};
